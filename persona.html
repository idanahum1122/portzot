<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<title>×¤×•×¨×¦×•×ª ×“×¨×š â€“ ×‘× ×™×™×ª ×¤×¨×¡×•× ×”</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;600;700&family=Assistant:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Assistant', sans-serif;
    direction: rtl;
    margin: 0;
    background: #f3f4f6;
    padding: 20px;
}

#formArea {
    max-width: 850px;
    margin: 0 auto;
    background: white;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

h1 { color: #e91e63; font-family: 'Rubik'; text-align: center; }
h2 { color: #00a7b5; border-bottom: 2px solid #eee; padding-bottom: 5px; margin-top: 30px; }

label { display: block; font-weight: 600; margin-bottom: 8px; margin-top: 15px; }

input[type="text"], textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 16px;
    box-sizing: border-box;
}

textarea {
    min-height: 80px;
    resize: vertical;
}

.checkbox-list {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    margin-top: 5px;
}

.checkbox-list label {
    font-weight: normal;
    display: block;
    cursor: pointer;
    margin: 5px 0;
}

button {
    background: linear-gradient(90deg, #e91e63, #00a7b5);
    color: white;
    border: none;
    padding: 18px;
    font-size: 20px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 700;
    width: 100%;
    margin-top: 30px;
}

button:hover {
    opacity: 0.9;
}
</style>
</head>

<body>

<div id="formArea">
<h1>×‘× ×™×™×ª ×¤×¨×¡×•× ×” â€“ ×¤×•×¨×¦×•×ª ×“×¨×š ğŸ€</h1>

<div style="background: #fff0f5; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
<label>×©××•×ª ×—×‘×¨×•×ª ×”×¦×•×•×ª:</label>
<input type="text" id="teamNames" placeholder="×¨×©××• ××ª ×©××•×ª ×—×‘×¨×•×ª ×”×¦×•×•×ª">
</div>

<h2>×—×œ×§ ×' â€“ ××™ ×”×™×?</h2>
<div style="display:flex; gap:10px;">
<div style="flex:2;">
<label>×©× ×”×¤×¨×¡×•× ×”:</label>
<input type="text" id="name" placeholder="×œ×“×•×’××”: × ×•×¢×”">
</div>
<div style="flex:1;">
<label>×’×™×œ:</label>
<input type="text" id="age" placeholder="16">
</div>
</div>

<label>××” ×××¤×™×™×Ÿ ××ª ×©×’×¨×ª ×”×—×™×™× ×©×œ×”?</label>
<div class="checkbox-list">
<label><input type="checkbox" class="routine" value="×ª×œ××™×“×” ×©××ª××§×“×ª ×‘×¢×™×§×¨ ×‘×œ×™××•×“×™×"> ×ª×œ××™×“×” ×©××ª××§×“×ª ×‘×¢×™×§×¨ ×‘×œ×™××•×“×™×</label>
<label><input type="checkbox" class="routine" value="××©×œ×‘×ª ×œ×™××•×“×™× ×¢× ×—×•×’×™× / ××™××•× ×™×"> ××©×œ×‘×ª ×œ×™××•×“×™× ×¢× ×—×•×’×™× / ××™××•× ×™×</label>
<label><input type="checkbox" class="routine" value="×¤×¢×™×œ×” ×‘×ª× ×•×¢×ª × ×•×¢×¨ / ××¡×’×¨×ª ×—×‘×¨×ª×™×ª"> ×¤×¢×™×œ×” ×‘×ª× ×•×¢×ª × ×•×¢×¨ / ××¡×’×¨×ª ×—×‘×¨×ª×™×ª</label>
<label><input type="checkbox" class="routine" value="×¢×•×‘×“×ª ××—×¨×™ ×©×¢×•×ª ×”×œ×™××•×“×™×"> ×¢×•×‘×“×ª ××—×¨×™ ×©×¢×•×ª ×”×œ×™××•×“×™×</label>
<label><input type="checkbox" class="routine" value="×œ×•×§×—×ª ××—×¨×™×•×ª ×‘×‘×™×ª (××—×™× / ××˜×œ×•×ª ×§×‘×•×¢×•×ª)"> ×œ×•×§×—×ª ××—×¨×™×•×ª ×‘×‘×™×ª (××—×™× / ××˜×œ×•×ª ×§×‘×•×¢×•×ª)</label>
<div style="display:flex; align-items:center; gap:5px; margin-top:5px;">
<span>××—×¨:</span>
<input type="text" id="routineOther" style="margin:0; height:30px;">
</div>
</div>

<label>×›×š × ×¨××™×ª ×”×©×’×¨×” ×©×œ×” ×‘×§×¦×¨×”:</label>
<textarea id="routineText" placeholder="×ª××¨×• ××ª ×”×™×•× ×©×œ×”..."></textarea>

<h2>×—×œ×§ ×‘' â€“ ×”×¡×™×˜×•××¦×™×” ×©×‘×” ××•×¤×™×¢×” ×”×‘×¢×™×”</h2>
<label>××™×¤×” ×”×™× × ××¦××ª ×¨×•×‘ ×”×™×•×?</label>
<div class="checkbox-list">
<label><input type="checkbox" class="location" value="×‘×‘×™×ª ×”×¡×¤×¨"> ×‘×‘×™×ª ×”×¡×¤×¨</label>
<label><input type="checkbox" class="location" value="×‘×‘×™×ª"> ×‘×‘×™×ª</label>
<label><input type="checkbox" class="location" value="×‘×ª×—×‘×•×¨×” ×¦×™×‘×•×¨×™×ª"> ×‘×ª×—×‘×•×¨×” ×¦×™×‘×•×¨×™×ª</label>
<label><input type="checkbox" class="location" value="×‘××™××•×Ÿ / ×—×•×’"> ×‘××™××•×Ÿ / ×—×•×’</label>
<label><input type="checkbox" class="location" value="×¢× ×—×‘×¨×™×"> ×¢× ×—×‘×¨×™×</label>
<div style="display:flex; align-items:center; gap:5px; margin-top:5px;">
<span>××—×¨:</span>
<input type="text" id="locationOther" style="margin:0; height:30px;">
</div>
</div>

<label>××ª×™ ×”×‘×¢×™×” ××•×¤×™×¢×”? (×–××Ÿ + ××§×•× + ××¦×‘)</label>
<textarea id="moment" placeholder="×œ×“×•×’××”: ×›×œ ×‘×•×§×¨ ×‘×“×¨×š ×œ×‘×™×ª ×”×¡×¤×¨..."></textarea>

<label>××” ×§×•×¨×” ×‘×¤×•×¢×œ ×‘××•×ª×• ×¨×’×¢? (×ª×™××•×¨ ×”×ª× ×”×’×•×ª×™)</label>
<textarea id="action" placeholder="×ª××¨×• ××” ×§×•×¨×”..."></textarea>

<h2>×—×œ×§ ×’' â€“ ×¢×•××§ ×¨×’×©×™ ×•×ª×¤×§×•×“×™</h2>
<label>××” ×”×™× ××¨×’×™×©×” ×‘×¡×™×˜×•××¦×™×” ×”×–×•?</label>
<textarea id="emotion" placeholder="×œ×“×•×’××”: ××ª×•×¡×›×œ×ª, ××‘×•×™×©×ª..."></textarea>

<label>××™×š ×–×” ××©×¤×™×¢ ×¢×œ×™×”?</label>
<div class="checkbox-list" style="display:flex; flex-wrap:wrap; gap:15px;">
<label><input type="checkbox" class="impactType" value="×œ×™××•×“×™×ª"> ×œ×™××•×“×™×ª</label>
<label><input type="checkbox" class="impactType" value="×—×‘×¨×ª×™×ª"> ×—×‘×¨×ª×™×ª</label>
<label><input type="checkbox" class="impactType" value="×¨×’×©×™×ª"> ×¨×’×©×™×ª</label>
<label><input type="checkbox" class="impactType" value="× ×™×”×•×œ ×–××Ÿ"> × ×™×”×•×œ ×–××Ÿ</label>
<div style="display:flex; align-items:center; gap:5px;">
<span>××—×¨:</span>
<input type="text" id="impactOther" style="margin:0; width:150px; height:30px;">
</div>
</div>

<label>×”×¡×‘×¨ ×§×¦×¨ ×¢×œ ×”×”×©×¤×¢×”:</label>
<textarea id="impactText" placeholder="×”×¡×‘×™×¨×• ×›×™×¦×“ ×”×‘×¢×™×” ××©×¤×™×¢×”..."></textarea>

<h2>×—×œ×§ ×“' â€“ × ×™×¡×•×— ×™×–××™ ××“×•×™×§</h2>
<label>×¦×™×˜×•×˜ ×©××™×™×¦×’ ××•×ª×”:</label>
<input type="text" id="quote" placeholder='"×× ×™ ×ª××™×“ ×××—×¨×ª..."'>

<label>××©×¤×˜ ×”×‘×¢×™×”:</label>
<div style="background:#f0f0f0; padding:15px; border-radius:8px;">
× ×¢×¨×•×ª ×‘×’×™×œ <input type="text" id="pAge" style="width:50px; margin:0;" placeholder="16"> ××©×¨ <input type="text" id="pWho" style="width:200px; margin:0;" placeholder="×œ×•××“×•×ª ×‘×ª×™×›×•×Ÿ"> <br><br>
××ª×§×©×•×ª ×‘-<input type="text" id="pDifficulty" style="width:200px; margin:0;" placeholder="× ×™×”×•×œ ×–××Ÿ"> ×›××©×¨ <input type="text" id="pWhen" style="width:200px; margin:0;" placeholder="××©×œ×‘×•×ª ×¤×¢×™×œ×•×™×•×ª ×¨×‘×•×ª">.
</div>

<button onclick="generatePDF()">ğŸ€ ×”×•×¨×“×ª PDF</button>
</div>

<!-- Hidden canvas for PDF generation -->
<canvas id="pdfCanvas" style="display:none;"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
function getValues(className, otherId) {
    let vals = Array.from(document.querySelectorAll('.' + className + ':checked')).map(cb => cb.value);
    let other = document.getElementById(otherId).value.trim();
    if (other) vals.push(other);
    return vals.length > 0 ? vals.join(', ') : '×œ× ×¦×•×™×Ÿ';
}

async function generatePDF() {
    const team = document.getElementById('teamNames').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const name = document.getElementById('name').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const age = document.getElementById('age').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const routine = getValues('routine', 'routineOther');
    const routineText = document.getElementById('routineText').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const location = getValues('location', 'locationOther');
    const moment = document.getElementById('moment').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const action = document.getElementById('action').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const emotion = document.getElementById('emotion').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const impactType = getValues('impactType', 'impactOther');
    const impactText = document.getElementById('impactText').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const quote = document.getElementById('quote').value.trim() || '×œ× ×¦×•×™×Ÿ';

    const pAge = document.getElementById('pAge').value.trim() || '___';
    const pWho = document.getElementById('pWho').value.trim() || '___';
    const pDifficulty = document.getElementById('pDifficulty').value.trim() || '___';
    const pWhen = document.getElementById('pWhen').value.trim() || '___';

    const problemSentence = `× ×¢×¨×•×ª ×‘×’×™×œ ${pAge} ××©×¨ ${pWho} ××ª×§×©×•×ª ×‘-${pDifficulty} ×›××©×¨ ${pWhen}.`;

    // Load image as base64
    let imgData = '';
    try {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        await new Promise((resolve, reject) => {
            img.onload = () => {
                const canvas = document.createElement('canvas');
                canvas.width = img.width;
                canvas.height = img.height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0);
                imgData = canvas.toDataURL('image/png');
                resolve();
            };
            img.onerror = () => {
                console.log('Could not load image');
                resolve(); // Continue without image
            };
            img.src = 'girl.png';
        });
    } catch(e) {
        console.log('Image error:', e);
    }

    // Create PDF content div
    const pdfDiv = document.createElement('div');
    pdfDiv.style.width = '800px';
    pdfDiv.style.padding = '40px';
    pdfDiv.style.background = 'white';
    pdfDiv.style.fontFamily = 'Arial, sans-serif';
    pdfDiv.style.direction = 'rtl';
    pdfDiv.style.position = 'absolute';
    pdfDiv.style.right = '0';
    pdfDiv.style.top = '0';

    pdfDiv.innerHTML = `
        <div style="display: flex; gap: 30px;">
            <div style="flex: 2;">
                <h2 style="color: #e91e63; font-size: 24px; margin-bottom: 20px; border-bottom: 3px solid #00a7b5; padding-bottom: 10px;">×”×’×“×¨×ª ×”×¤×¨×¡×•× ×” ×©×œ: ${team}</h2>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 14px;"><strong style="color: #00a7b5;">×©×:</strong> ${name} | <strong style="color: #00a7b5;">×’×™×œ:</strong> ${age}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">×©×’×¨×ª ×—×™×™×:</strong> ${routine}</p>
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;">${routineText}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">××™×§×•××™× ×¢×™×§×¨×™×™×:</strong> ${location}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">××ª×™ ×”×‘×¢×™×” ××•×¤×™×¢×”:</strong> ${moment}</p>
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">××” ×§×•×¨×” ×‘×¤×•×¢×œ:</strong> ${action}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">×”×¨×’×©×”:</strong> ${emotion}</p>
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;"><strong style="color: #00a7b5;">×ª×—×•××™ ×”×©×¤×¢×”:</strong> ${impactType}</p>
                    <p style="margin: 8px 0; line-height: 1.6; font-size: 13px;">${impactText}</p>
                </div>
                
                <div style="background: #fff0f5; padding: 15px; border-radius: 8px; font-style: italic; text-align: center; margin: 20px 0; font-size: 15px;">
                    "${quote}"
                </div>
                
                <div style="background: #e91e63; color: white; padding: 20px; border-radius: 10px; margin: 20px 0; font-size: 14px; font-weight: 600; text-align: center; line-height: 1.8;">
                    ${problemSentence}
                </div>
            </div>
            <div id="imageContainer" style="flex: 1; display: flex; align-items: flex-end; justify-content: center;">
                ${imgData ? `<img src="${imgData}" style="max-width: 100%; height: auto; max-height: 400px;">` : ''}
            </div>
        </div>
    `;

    document.body.appendChild(pdfDiv);

    try {
        const canvas = await html2canvas(pdfDiv, {
            scale: 2,
            useCORS: true,
            allowTaint: true,
            backgroundColor: '#ffffff',
            windowWidth: 800
        });

        const imgWidth = 210; // A4 width in mm
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        
        const imgDataUrl = canvas.toDataURL('image/png');
        pdf.addImage(imgDataUrl, 'PNG', 0, 0, imgWidth, imgHeight);
        
        pdf.save(`persona_${name}_${Date.now()}.pdf`);
        
        document.body.removeChild(pdfDiv);
    } catch (err) {
        console.error('Error generating PDF:', err);
        alert('×©×’×™××” ×‘×™×¦×™×¨×ª PDF: ' + err.message);
        document.body.removeChild(pdfDiv);
    }
}
</script>

</body>
</html>
