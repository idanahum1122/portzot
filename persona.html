<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<title>×¤×•×¨×¦×•×ª ×“×¨×š â€“ ×‘× ×™×™×ª ×¤×¨×¡×•× ×”</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;600;700&family=Assistant:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Assistant', sans-serif;
    direction: rtl;
    margin: 0;
    background: #f3f4f6;
    padding: 20px;
}

#formArea {
    max-width: 850px;
    margin: 0 auto;
    background: white;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

h1 { color: #e91e63; font-family: 'Rubik'; text-align: center; }
h2 { color: #00a7b5; border-bottom: 2px solid #eee; padding-bottom: 5px; margin-top: 30px; }

label { display: block; font-weight: 600; margin-bottom: 8px; margin-top: 15px; }

input[type="text"], textarea {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 16px;
    box-sizing: border-box;
}

textarea {
    min-height: 80px;
    resize: vertical;
}

.checkbox-list {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    margin-top: 5px;
}

.checkbox-list label {
    font-weight: normal;
    display: block;
    cursor: pointer;
    margin: 5px 0;
}

button {
    background: linear-gradient(90deg, #e91e63, #00a7b5);
    color: white;
    border: none;
    padding: 18px;
    font-size: 20px;
    border-radius: 50px;
    cursor: pointer;
    font-weight: 700;
    width: 100%;
    margin-top: 30px;
}

button:hover {
    opacity: 0.9;
}
</style>
</head>

<body>

<div id="formArea">
<h1>×‘× ×™×™×ª ×¤×¨×¡×•× ×” â€“ ×¤×•×¨×¦×•×ª ×“×¨×š ğŸ€</h1>

<div style="background: #fff0f5; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
<label>×©××•×ª ×—×‘×¨×•×ª ×”×¦×•×•×ª:</label>
<input type="text" id="teamNames" placeholder="×¨×©××• ××ª ×©××•×ª ×—×‘×¨×•×ª ×”×¦×•×•×ª">
</div>

<h2>×—×œ×§ ×' â€“ ××™ ×”×™×?</h2>
<div style="display:flex; gap:10px;">
<div style="flex:2;">
<label>×©× ×”×¤×¨×¡×•× ×”:</label>
<input type="text" id="name" placeholder="×œ×“×•×’××”: × ×•×¢×”">
</div>
<div style="flex:1;">
<label>×’×™×œ:</label>
<input type="text" id="age" placeholder="16">
</div>
</div>

<label>××” ×××¤×™×™×Ÿ ××ª ×©×’×¨×ª ×”×—×™×™× ×©×œ×”?</label>
<div class="checkbox-list">
<label><input type="checkbox" class="routine" value="×ª×œ××™×“×” ×©××ª××§×“×ª ×‘×¢×™×§×¨ ×‘×œ×™××•×“×™×"> ×ª×œ××™×“×” ×©××ª××§×“×ª ×‘×¢×™×§×¨ ×‘×œ×™××•×“×™×</label>
<label><input type="checkbox" class="routine" value="××©×œ×‘×ª ×œ×™××•×“×™× ×¢× ×—×•×’×™× / ××™××•× ×™×"> ××©×œ×‘×ª ×œ×™××•×“×™× ×¢× ×—×•×’×™× / ××™××•× ×™×</label>
<label><input type="checkbox" class="routine" value="×¤×¢×™×œ×” ×‘×ª× ×•×¢×ª × ×•×¢×¨ / ××¡×’×¨×ª ×—×‘×¨×ª×™×ª"> ×¤×¢×™×œ×” ×‘×ª× ×•×¢×ª × ×•×¢×¨ / ××¡×’×¨×ª ×—×‘×¨×ª×™×ª</label>
<label><input type="checkbox" class="routine" value="×¢×•×‘×“×ª ××—×¨×™ ×©×¢×•×ª ×”×œ×™××•×“×™×"> ×¢×•×‘×“×ª ××—×¨×™ ×©×¢×•×ª ×”×œ×™××•×“×™×</label>
<label><input type="checkbox" class="routine" value="×œ×•×§×—×ª ××—×¨×™×•×ª ×‘×‘×™×ª (××—×™× / ××˜×œ×•×ª ×§×‘×•×¢×•×ª)"> ×œ×•×§×—×ª ××—×¨×™×•×ª ×‘×‘×™×ª (××—×™× / ××˜×œ×•×ª ×§×‘×•×¢×•×ª)</label>
<div style="display:flex; align-items:center; gap:5px; margin-top:5px;">
<span>××—×¨:</span>
<input type="text" id="routineOther" style="margin:0; height:30px;">
</div>
</div>

<label>×›×š × ×¨××™×ª ×”×©×’×¨×” ×©×œ×” ×‘×§×¦×¨×”:</label>
<textarea id="routineText" placeholder="×ª××¨×• ××ª ×”×™×•× ×©×œ×”..."></textarea>

<h2>×—×œ×§ ×‘' â€“ ×”×¡×™×˜×•××¦×™×” ×©×‘×” ××•×¤×™×¢×” ×”×‘×¢×™×”</h2>
<label>××™×¤×” ×”×™× × ××¦××ª ×¨×•×‘ ×”×™×•×?</label>
<div class="checkbox-list">
<label><input type="checkbox" class="location" value="×‘×‘×™×ª ×”×¡×¤×¨"> ×‘×‘×™×ª ×”×¡×¤×¨</label>
<label><input type="checkbox" class="location" value="×‘×‘×™×ª"> ×‘×‘×™×ª</label>
<label><input type="checkbox" class="location" value="×‘×ª×—×‘×•×¨×” ×¦×™×‘×•×¨×™×ª"> ×‘×ª×—×‘×•×¨×” ×¦×™×‘×•×¨×™×ª</label>
<label><input type="checkbox" class="location" value="×‘××™××•×Ÿ / ×—×•×’"> ×‘××™××•×Ÿ / ×—×•×’</label>
<label><input type="checkbox" class="location" value="×¢× ×—×‘×¨×™×"> ×¢× ×—×‘×¨×™×</label>
<div style="display:flex; align-items:center; gap:5px; margin-top:5px;">
<span>××—×¨:</span>
<input type="text" id="locationOther" style="margin:0; height:30px;">
</div>
</div>

<label>××ª×™ ×”×‘×¢×™×” ××•×¤×™×¢×”? (×–××Ÿ + ××§×•× + ××¦×‘)</label>
<textarea id="moment" placeholder="×œ×“×•×’××”: ×›×œ ×‘×•×§×¨ ×‘×“×¨×š ×œ×‘×™×ª ×”×¡×¤×¨..."></textarea>

<label>××” ×§×•×¨×” ×‘×¤×•×¢×œ ×‘××•×ª×• ×¨×’×¢? (×ª×™××•×¨ ×”×ª× ×”×’×•×ª×™)</label>
<textarea id="action" placeholder="×ª××¨×• ××” ×§×•×¨×”..."></textarea>

<h2>×—×œ×§ ×’' â€“ ×¢×•××§ ×¨×’×©×™ ×•×ª×¤×§×•×“×™</h2>
<label>××” ×”×™× ××¨×’×™×©×” ×‘×¡×™×˜×•××¦×™×” ×”×–×•?</label>
<textarea id="emotion" placeholder="×œ×“×•×’××”: ××ª×•×¡×›×œ×ª, ××‘×•×™×©×ª..."></textarea>

<label>××™×š ×–×” ××©×¤×™×¢ ×¢×œ×™×”?</label>
<div class="checkbox-list" style="display:flex; flex-wrap:wrap; gap:15px;">
<label><input type="checkbox" class="impactType" value="×œ×™××•×“×™×ª"> ×œ×™××•×“×™×ª</label>
<label><input type="checkbox" class="impactType" value="×—×‘×¨×ª×™×ª"> ×—×‘×¨×ª×™×ª</label>
<label><input type="checkbox" class="impactType" value="×¨×’×©×™×ª"> ×¨×’×©×™×ª</label>
<label><input type="checkbox" class="impactType" value="× ×™×”×•×œ ×–××Ÿ"> × ×™×”×•×œ ×–××Ÿ</label>
<div style="display:flex; align-items:center; gap:5px;">
<span>××—×¨:</span>
<input type="text" id="impactOther" style="margin:0; width:150px; height:30px;">
</div>
</div>

<label>×”×¡×‘×¨ ×§×¦×¨ ×¢×œ ×”×”×©×¤×¢×”:</label>
<textarea id="impactText" placeholder="×”×¡×‘×™×¨×• ×›×™×¦×“ ×”×‘×¢×™×” ××©×¤×™×¢×”..."></textarea>

<h2>×—×œ×§ ×“' â€“ × ×™×¡×•×— ×™×–××™ ××“×•×™×§</h2>
<label>×¦×™×˜×•×˜ ×©××™×™×¦×’ ××•×ª×”:</label>
<input type="text" id="quote" placeholder='"×× ×™ ×ª××™×“ ×××—×¨×ª..."'>

<label>××©×¤×˜ ×”×‘×¢×™×”:</label>
<div style="background:#f0f0f0; padding:15px; border-radius:8px;">
× ×¢×¨×•×ª ×‘×’×™×œ <input type="text" id="pAge" style="width:50px; margin:0;" placeholder="16"> ××©×¨ <input type="text" id="pWho" style="width:200px; margin:0;" placeholder="×œ×•××“×•×ª ×‘×ª×™×›×•×Ÿ"> <br><br>
××ª×§×©×•×ª ×‘-<input type="text" id="pDifficulty" style="width:200px; margin:0;" placeholder="× ×™×”×•×œ ×–××Ÿ"> ×›××©×¨ <input type="text" id="pWhen" style="width:200px; margin:0;" placeholder="××©×œ×‘×•×ª ×¤×¢×™×œ×•×™×•×ª ×¨×‘×•×ª">.
</div>

<button onclick="generatePDF()">ğŸ€ ×”×•×¨×“×ª PDF</button>
</div>

<!-- Hidden image for conversion to base64 -->
<img id="girlImage" src="girl.png" style="display:none;" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
let imageBase64 = '';

// Convert image to base64 on page load
window.addEventListener('load', function() {
    const img = document.getElementById('girlImage');
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    
    img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.drawImage(img, 0, 0);
        try {
            imageBase64 = canvas.toDataURL('image/png');
        } catch(e) {
            console.log('Could not convert image to base64:', e);
        }
    };
    
    // Trigger load if image is already cached
    if (img.complete) {
        img.onload();
    }
});

function getValues(className, otherId) {
    let vals = Array.from(document.querySelectorAll('.' + className + ':checked')).map(cb => cb.value);
    let other = document.getElementById(otherId).value.trim();
    if (other) vals.push(other);
    return vals.length > 0 ? vals.join(', ') : '×œ× ×¦×•×™×Ÿ';
}

function generatePDF() {
    const team = document.getElementById('teamNames').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const name = document.getElementById('name').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const age = document.getElementById('age').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const routine = getValues('routine', 'routineOther');
    const routineText = document.getElementById('routineText').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const location = getValues('location', 'locationOther');
    const moment = document.getElementById('moment').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const action = document.getElementById('action').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const emotion = document.getElementById('emotion').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const impactType = getValues('impactType', 'impactOther');
    const impactText = document.getElementById('impactText').value.trim() || '×œ× ×¦×•×™×Ÿ';
    const quote = document.getElementById('quote').value.trim() || '×œ× ×¦×•×™×Ÿ';

    const pAge = document.getElementById('pAge').value.trim() || '___';
    const pWho = document.getElementById('pWho').value.trim() || '___';
    const pDifficulty = document.getElementById('pDifficulty').value.trim() || '___';
    const pWhen = document.getElementById('pWhen').value.trim() || '___';

    const problemSentence = `× ×¢×¨×•×ª ×‘×’×™×œ ${pAge} ××©×¨ ${pWho} ××ª×§×©×•×ª ×‘-${pDifficulty} ×›××©×¨ ${pWhen}.`;

    // Use base64 image or placeholder
    const imgSrc = imageBase64 || '';
    const imgTag = imgSrc ? `<img src="${imgSrc}" style="max-width: 100%; height: auto; max-height: 400px;" alt="×“××•×ª ×¤×¨×¡×•× ×”">` : '';

    // Create PDF content with INLINE styles
    const pdfContent = `
    <div style="width: 210mm; min-height: 297mm; padding: 20mm; box-sizing: border-box; background: white; font-family: Arial, sans-serif; direction: rtl; color: #000;">
        <div style="display: flex; gap: 30px;">
            <div style="flex: 2;">
                <h2 style="color: #e91e63; font-size: 24px; margin-bottom: 20px; border-bottom: 3px solid #00a7b5; padding-bottom: 10px;">×”×’×“×¨×ª ×”×¤×¨×¡×•× ×” ×©×œ: ${team}</h2>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">×©×:</strong> ${name} | <strong style="color: #00a7b5;">×’×™×œ:</strong> ${age}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">×©×’×¨×ª ×—×™×™×:</strong> ${routine}</p>
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;">${routineText}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">××™×§×•××™× ×¢×™×§×¨×™×™×:</strong> ${location}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">××ª×™ ×”×‘×¢×™×” ××•×¤×™×¢×”:</strong> ${moment}</p>
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">××” ×§×•×¨×” ×‘×¤×•×¢×œ:</strong> ${action}</p>
                </div>
                
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; margin: 15px 0; border-right: 4px solid #e91e63;">
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">×”×¨×’×©×”:</strong> ${emotion}</p>
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;"><strong style="color: #00a7b5;">×ª×—×•××™ ×”×©×¤×¢×”:</strong> ${impactType}</p>
                    <p style="margin: 8px 0; line-height: 1.8; font-size: 14px; color: #000;">${impactText}</p>
                </div>
                
                <div style="background: #fff0f5; padding: 15px; border-radius: 8px; font-style: italic; text-align: center; margin: 20px 0; font-size: 16px; color: #000;">
                    "${quote}"
                </div>
                
                <div style="background: linear-gradient(135deg, #e91e63, #00a7b5); color: white; padding: 20px; border-radius: 10px; margin: 20px 0; font-size: 15px; font-weight: 600; text-align: center; line-height: 1.8;">
                    ${problemSentence}
                </div>
            </div>
            <div style="flex: 1; display: flex; align-items: flex-end; justify-content: center;">
                ${imgTag}
            </div>
        </div>
    </div>`;

    // Create temporary element for PDF
    const tempDiv = document.createElement('div');
    tempDiv.innerHTML = pdfContent;
    tempDiv.style.position = 'absolute';
    tempDiv.style.left = '-9999px';
    document.body.appendChild(tempDiv);

    const element = tempDiv.querySelector('div');

    if (typeof html2pdf === 'undefined') {
        alert('×¡×¤×¨×™×™×ª PDF ×œ× × ×˜×¢× ×”. ×‘×“×•×§ ×—×™×‘×•×¨ ××™× ×˜×¨× ×˜.');
        document.body.removeChild(tempDiv);
        return;
    }

    html2pdf().set({
        margin: [10, 10, 10, 10],
        filename: `persona_${name}_${new Date().getTime()}.pdf`,
        html2canvas: { 
            scale: 2,
            useCORS: true,
            allowTaint: true,
            letterRendering: true,
            backgroundColor: '#ffffff'
        },
        jsPDF: { 
            unit: 'mm', 
            format: 'a4', 
            orientation: 'portrait',
            compress: true
        }
    }).from(element).save().then(() => {
        document.body.removeChild(tempDiv);
    }).catch(err => {
        console.error('Error generating PDF:', err);
        alert('×©×’×™××” ×‘×™×¦×™×¨×ª PDF. × ×¡×” ×©×•×‘.');
        document.body.removeChild(tempDiv);
    });
}
</script>

</body>
</html>
