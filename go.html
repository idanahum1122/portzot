<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<title>בדיקת מציאות והגדרת מוצר (GO)</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;600;700&family=Assistant:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Assistant', sans-serif;
    direction: rtl;
    margin: 0;
    background: #f4f5f7;
    padding: 20px;
}

#formArea {
    max-width: 900px;
    margin: 0 auto;
    background: white;
    padding: 40px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.06);
}

h1 {
    font-family: 'Rubik';
    text-align: center;
    color: #7c3aed;
}

h2 {
    margin-top: 40px;
    color: #111827;
    border-bottom: 2px solid #eee;
    padding-bottom: 6px;
}

label {
    display: block;
    font-weight: 600;
    margin: 20px 0 8px;
}

textarea, input[type="text"] {
    width: 100%;
    padding: 10px;
    font-size: 15px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    box-sizing: border-box;
}

textarea {
    min-height: 70px;
    resize: vertical;
}

.checkboxArea {
    margin-top: 20px;
}

.checkboxArea label {
    font-weight: 500;
    display: block;
    margin: 8px 0;
    cursor: pointer;
}

/* GO highlight */
#sectionB {
    border: 2px solid transparent;
    border-radius: 12px;
    padding: 8px 12px 16px;
    margin-top: 20px;
    transition: border-color 0.2s ease, background-color 0.2s ease;
}

#sectionB.go-active {
    border-color: #16a34a;
    background-color: #f0fdf4;
}

#sectionB .go-label {
    color: #166534;
    font-weight: 700;
}

/* PDF area */
#summaryArea {
    display: none;
    direction: rtl;
    text-align: right;
    font-family: Arial, sans-serif;
    color: #111827;
    line-height: 1.7;
}

button {
    margin-top: 40px;
    width: 100%;
    padding: 18px;
    font-size: 18px;
    border: none;
    border-radius: 40px;
    background: linear-gradient(90deg,#7c3aed,#ec4899);
    color: white;
    font-weight: 700;
    cursor: pointer;
}
</style>
</head>

<body>

<div id="formArea">

<h1>דף עבודה – בדיקת מציאות והגדרת מוצר</h1>

<h2>חלק א’ – בדיקת מציאות</h2>

<label>1. מה הבעיה המדויקת שהמוצר פותר?</label>
<textarea id="problem1"></textarea>

<label>2. למי זה מתאים?</label>
<textarea id="audience"></textarea>

<label>3. למה זו בעיה אמיתית ולא רגעית?</label>
<textarea id="realProblem"></textarea>

<label>4. למה זה Must Have ולא Nice To Have?</label>
<textarea id="mustHave"></textarea>

<label>5. מה מייחד אותנו ממה שכבר קיים?</label>
<textarea id="unique"></textarea>

<div class="checkboxArea">
<label><input type="radio" name="decision" value="GO"> אנחנו מסמנות GO וממשיכות לאפיון</label>
<label><input type="radio" name="decision" value="REFINE"> אנחנו צריכות לדייק לפני שממשיכות</label>
</div>

<div id="sectionB">
<h2 id="sectionBHeading">חלק ב’ – אפיון ראשוני (רק אם סימנו GO)</h2>

<label>שם מוצר (זמני):</label>
<input type="text" id="productName">

<label>ניסוח סופי של הבעיה:</label>
<textarea id="finalProblem"></textarea>

<label>קהל יעד:</label>
<textarea id="finalAudience"></textarea>

<label>הפתרון שלנו:</label>
<textarea id="solution"></textarea>

<label>מה המשתמשת עושה בפועל?</label>
<textarea id="userAction"></textarea>

<label>מה משתנה לה אחרי שימוש?</label>
<textarea id="afterUse"></textarea>

<label>כך זה עובד – שלב 1:</label>
<textarea id="step1"></textarea>

<label>שלב 2:</label>
<textarea id="step2"></textarea>

<label>שלב 3:</label>
<textarea id="step3"></textarea>
</div>

<div id="summaryArea"></div>

<button onclick="generatePDF()">הורדת PDF</button>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function(){

function val(id){
    const el = document.getElementById(id);
    return el ? el.value.trim() || "לא צוין" : "לא צוין";
}

function toggleGoHighlight(){
    const decision = document.querySelector('input[name="decision"]:checked');
    const sectionB = document.getElementById('sectionB');
    const heading = document.getElementById('sectionBHeading');
    const isGo = decision && decision.value === 'GO';

    sectionB.classList.toggle('go-active', isGo);
    heading.classList.toggle('go-label', isGo);
}

document.querySelectorAll('input[name="decision"]').forEach(radio=>{
    radio.addEventListener("change", toggleGoHighlight);
});

toggleGoHighlight();

window.generatePDF = async function(){

    const decision = document.querySelector('input[name="decision"]:checked');
    const summaryArea = document.getElementById('summaryArea');
    const decisionValue = decision ? decision.value : 'לא סומן';
    const isGo = decisionValue === 'GO';

    // Load logo as base64 so html2canvas can render it
    let logoData = '';
    try {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        await new Promise((resolve) => {
            img.onload = () => {
                const c = document.createElement('canvas');
                c.width = img.width;
                c.height = img.height;
                c.getContext('2d').drawImage(img, 0, 0);
                logoData = c.toDataURL('image/png');
                resolve();
            };
            img.onerror = () => resolve();
            img.src = 'logo.png';
        });
    } catch(e) {}

    const partA = [
        ['מה הבעיה המדויקת?', val('problem1')],
        ['למי זה מתאים?', val('audience')],
        ['למה זו בעיה אמיתית?', val('realProblem')],
        ['למה זה Must Have?', val('mustHave')],
        ['מה מייחד אותנו?', val('unique')],
    ];

    const partB = isGo ? [
        ['שם מוצר', val('productName')],
        ['ניסוח סופי של הבעיה', val('finalProblem')],
        ['קהל יעד', val('finalAudience')],
        ['הפתרון שלנו', val('solution')],
        ['מה המשתמשת עושה?', val('userAction')],
        ['מה משתנה אחרי שימוש?', val('afterUse')],
        ['שלב 1', val('step1')],
        ['שלב 2', val('step2')],
        ['שלב 3', val('step3')],
    ] : [];

    const decisionColor = isGo ? '#16a34a' : '#dc2626';
    const decisionBg   = isGo ? '#f0fdf4'  : '#fef2f2';

    summaryArea.innerHTML = `
        <div style="font-family:Arial,sans-serif;direction:rtl;text-align:right;width:750px;background:white;padding:30px;box-sizing:border-box;color:#111827;">

            <!-- Header -->
            <div style="background:linear-gradient(135deg,#7c3aed,#ec4899);padding:18px 24px;border-radius:12px;display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;">
                <h2 style="color:white;margin:0;font-family:Arial,sans-serif;font-size:18px;">דף עבודה – בדיקת מציאות והגדרת מוצר</h2>
                ${logoData ? `<img src="${logoData}" style="height:55px;width:auto;">` : ''}
            </div>

            <!-- Part A -->
            <h3 style="font-family:Arial,sans-serif;color:#7c3aed;border-bottom:2px solid #e9d5ff;padding-bottom:6px;margin-bottom:14px;margin-top:0;">חלק א׳ – בדיקת מציאות</h3>
            ${partA.map(([title, content]) => `
                <div style="background:#f5f3ff;border-right:4px solid #7c3aed;padding:10px 14px;border-radius:0 6px 6px 0;margin-bottom:10px;">
                    <p style="margin:0;font-family:Arial,sans-serif;font-size:13px;line-height:1.7;">
                        <strong style="color:#6d28d9;">${title}</strong><br>${content}
                    </p>
                </div>
            `).join('')}

            <!-- Decision -->
            <div style="background:${decisionBg};border:2px solid ${decisionColor};padding:14px 18px;border-radius:10px;margin:20px 0;text-align:center;">
                <span style="font-family:Arial,sans-serif;font-size:17px;font-weight:700;color:${decisionColor};">החלטה: ${decisionValue}</span>
            </div>

            ${isGo ? `
            <!-- Part B -->
            <h3 style="font-family:Arial,sans-serif;color:#16a34a;border-bottom:2px solid #bbf7d0;padding-bottom:6px;margin-bottom:14px;margin-top:0;">חלק ב׳ – אפיון ראשוני</h3>
            ${partB.map(([title, content]) => `
                <div style="background:#f0fdf4;border-right:4px solid #16a34a;padding:10px 14px;border-radius:0 6px 6px 0;margin-bottom:10px;">
                    <p style="margin:0;font-family:Arial,sans-serif;font-size:13px;line-height:1.7;">
                        <strong style="color:#15803d;">${title}</strong><br>${content}
                    </p>
                </div>
            `).join('')}
            ` : ''}
        </div>
    `;

    summaryArea.style.display = 'block';
    await document.fonts.ready;

    await html2pdf().from(summaryArea).set({
        margin: 10,
        filename: 'GO_product_definition.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true, letterRendering: true, logging: false, backgroundColor: '#ffffff' },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    }).save();

    summaryArea.style.display = 'none';
};

});
</script>

</body>
</html>
