<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×©××œ×•×Ÿ ×–×™×•×•×’ - ×¤×•×¨×¦×•×ª ×“×¨×š</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(255,20,147,0.15) 0%, transparent 70%);
            pointer-events: none;
            animation: pulseGlow 4s ease-in-out infinite;
        }

        @keyframes pulseGlow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .container {
            max-width: 600px;
            width: 100%;
            position: relative;
            z-index: 1;
        }

        .card {
            background: rgba(20, 20, 20, 0.95);
            border: 2px solid #ff1493;
            border-radius: 24px;
            padding: 40px 32px;
            box-shadow: 0 0 40px rgba(255,20,147,0.3),
                        inset 0 0 60px rgba(255,20,147,0.05);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg,
                transparent 30%,
                rgba(255,20,147,0.1) 50%,
                transparent 70%);
            animation: rotate 8s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .progress-bar {
            background: rgba(255,20,147,0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
        }

        .progress-fill {
            background: linear-gradient(90deg, #ff1493, #ff69b4);
            height: 100%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px #ff1493;
        }

        .step {
            display: none;
            position: relative;
            z-index: 2;
            animation: fadeIn 0.5s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #ff1493;
            text-shadow: 0 0 20px rgba(255,20,147,0.5);
            margin-bottom: 24px;
            font-size: 28px;
            text-align: center;
        }

        .question {
            margin-bottom: 24px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #ff69b4;
            font-weight: 500;
        }

        input[type="text"],
        select {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.5);
            border: 1px solid #ff1493;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: #ff69b4;
            box-shadow: 0 0 15px rgba(255,20,147,0.5);
        }

        select option {
            background: #1a1a1a;
            color: #fff;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 32px;
            justify-content: space-between;
        }

        button {
            flex: 1;
            padding: 14px 28px;
            background: linear-gradient(135deg, #ff1493, #ff69b4);
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,20,147,0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,20,147,0.6);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        button.secondary {
            background: rgba(255,20,147,0.2);
            border: 1px solid #ff1493;
        }

        .warning {
            background: rgba(255,50,50,0.2);
            border: 1px solid #ff3232;
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            color: #ff6b6b;
            display: none;
        }

        .warning.show {
            display: block;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
            color: #ff1493;
            text-shadow: 0 0 20px rgba(255,20,147,0.7);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        @media (max-width: 768px) {
            .card { padding: 32px 24px; }
            h2 { font-size: 24px; }
            .button-group { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="logo">
                <h1>ğŸŒŸ ×©××œ×•×Ÿ ×–×™×•×•×’ ğŸŒŸ</h1>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <!-- ×©×œ×‘ 1 -->
            <div class="step active" id="step1">
                <h2>×¤×¨×˜×™× ×‘×¡×™×¡×™×™×</h2>
                <div class="question">
                    <label for="displayName">×©× ×œ×”×¦×’×” *</label>
                    <input type="text" id="displayName" placeholder="××™×š ×ª×¨×¦×™ ×©×™×§×¨××• ×œ×š?" required>
                </div>
                <div class="question">
                    <label for="mainDomain">×ª×—×•× ×¢×™×§×¨×™ *</label>
                    <select id="mainDomain" required>
                        <option value="">×‘×—×¨×™ ×ª×—×•×...</option>
                        <option value="frontend">×¤×™×ª×•×— Frontend</option>
                        <option value="backend">×¤×™×ª×•×— Backend</option>
                        <option value="fullstack">Fullstack</option>
                        <option value="data">Data Science</option>
                        <option value="design">×¢×™×¦×•×‘ UX/UI</option>
                        <option value="mobile">×¤×™×ª×•×— Mobile</option>
                        <option value="devops">DevOps</option>
                        <option value="qa">QA/Testing</option>
                    </select>
                </div>
                <div class="question">
                    <label for="secondDomain">×ª×—×•× ××©× ×™ (××•×¤×¦×™×•× ×œ×™)</label>
                    <select id="secondDomain">
                        <option value="">×‘×—×¨×™ ×ª×—×•×...</option>
                        <option value="frontend">×¤×™×ª×•×— Frontend</option>
                        <option value="backend">×¤×™×ª×•×— Backend</option>
                        <option value="fullstack">Fullstack</option>
                        <option value="data">Data Science</option>
                        <option value="design">×¢×™×¦×•×‘ UX/UI</option>
                        <option value="mobile">×¤×™×ª×•×— Mobile</option>
                        <option value="devops">DevOps</option>
                        <option value="qa">QA/Testing</option>
                    </select>
                </div>
                <div class="warning" id="warning1">×× × ××œ××™ ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×</div>
                <div class="button-group">
                    <button onclick="nextStep()">×”××©×š â†’</button>
                </div>
            </div>

            <!-- ×©×œ×‘ 2 -->
            <div class="step" id="step2">
                <h2>×¡×’× ×•×Ÿ ×¢×‘×•×“×”</h2>
                <div class="question">
                    <label for="workStyle">××™×š ××ª ××¢×“×™×¤×” ×œ×¢×‘×•×“? *</label>
                    <select id="workStyle" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="structured">×××•×¨×’× ×ª ×•××ª×•×›× × ×ª</option>
                        <option value="flexible">×’××™×©×” ×•×¡×¤×•× ×˜× ×™×ª</option>
                        <option value="detail">××“×•×™×§×ª ×•××¤×•×¨×˜×ª</option>
                        <option value="creative">×™×¦×™×¨×ª×™×ª ×•×—×•×¤×©×™×ª</option>
                    </select>
                </div>
                <div class="question">
                    <label for="teamStyle">××” ×”×ª×¤×§×™×“ ×”×˜×‘×¢×™ ×©×œ×š ×‘×¦×•×•×ª? *</label>
                    <select id="teamStyle" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="leader">××•×‘×™×œ×” ×•××ª×××ª</option>
                        <option value="executor">××‘×¦×¢×ª ×•×™×™×©×•××™×ª</option>
                        <option value="creative">×¨×¢×™×•× ×™×ª ×•×™×¦×™×¨×ª×™×ª</option>
                        <option value="analyzer">×× ×ª×—×ª ×•××“×™×™×§×ª</option>
                    </select>
                </div>
                <div class="question">
                    <label for="workPace">×§×¦×‘ ×¢×‘×•×“×” ××•×¢×“×£ *</label>
                    <select id="workPace" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="fast">××”×™×¨×” ×•××™× ×˜× ×¡×™×‘×™×ª</option>
                        <option value="steady">×™×¦×™×‘×” ×•×¢×§×‘×™×ª</option>
                        <option value="balanced">×××•×–× ×ª ×‘×™×Ÿ ×”×©× ×™×™×</option>
                    </select>
                </div>
                <div class="warning" id="warning2">×× × ××œ××™ ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×</div>
                <div class="button-group">
                    <button class="secondary" onclick="prevStep()">â† ×—×–×¨×”</button>
                    <button onclick="nextStep()">×”××©×š â†’</button>
                </div>
            </div>

            <!-- ×©×œ×‘ 3 -->
            <div class="step" id="step3">
                <h2>×ª×¤×§×™×“ ×‘×¦×•×•×ª</h2>
                <div class="question">
                    <label for="teamRole">××” ×”×ª×¤×§×™×“ ×©××ª ×”×›×™ ×˜×•×‘×” ×‘×•? *</label>
                    <select id="teamRole" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="ideas">×”×¦×¢×ª ×¨×¢×™×•× ×•×ª</option>
                        <option value="organization">××¨×’×•×Ÿ ×•×ª×›× ×•×Ÿ</option>
                        <option value="implementation">×™×™×©×•× ×•×‘×™×¦×•×¢</option>
                        <option value="testing">×‘×“×™×§×” ×•×©×™×¤×•×¨</option>
                    </select>
                </div>
                <div class="question">
                    <label for="motivationSource">××” ×× ×™×¢ ××•×ª×š? *</label>
                    <select id="motivationSource" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="achievement">×”×™×©×’×™× ××™×©×™×™×</option>
                        <option value="learning">×œ××™×“×” ×•×”×ª×¤×ª×—×•×ª</option>
                        <option value="impact">×”×©×¤×¢×” ×•×¢×¨×š</option>
                        <option value="collaboration">×©×™×ª×•×£ ×¤×¢×•×œ×”</option>
                    </select>
                </div>
                <div class="question">
                    <label for="pressureResponse">××™×š ××ª ××’×™×‘×” ×œ×œ×—×¥? *</label>
                    <select id="pressureResponse" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="thrives">××¦×˜×™×™× ×ª ×ª×—×ª ×œ×—×¥</option>
                        <option value="handles">××ª××•×“×“×ª ×”×™×˜×‘</option>
                        <option value="prefers_calm">××¢×“×™×¤×” ×¡×‘×™×‘×” ×¨×’×•×¢×”</option>
                    </select>
                </div>
                <div class="warning" id="warning3">×× × ××œ××™ ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×</div>
                <div class="button-group">
                    <button class="secondary" onclick="prevStep()">â† ×—×–×¨×”</button>
                    <button onclick="nextStep()">×”××©×š â†’</button>
                </div>
            </div>

            <!-- ×©×œ×‘ 4 -->
            <div class="step" id="step4">
                <h2>×ª×§×©×•×¨×ª ×•×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª</h2>
                <div class="question">
                    <label for="conflictStyle">××™×š ××ª ×¤×•×ª×¨×ª ×§×•× ×¤×œ×™×§×˜×™×? *</label>
                    <select id="conflictStyle" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="direct">×™×©×™×¨×” ×•×¤×ª×•×—×”</option>
                        <option value="diplomatic">×“×™×¤×œ×•××˜×™×ª ×•×¨×’×™×©×”</option>
                        <option value="analytical">×× ×ª×—×ª ×•×œ×•×’×™×ª</option>
                        <option value="mediating">××’×©×¨×ª ×•××¤×™×™×¡×ª</option>
                    </select>
                </div>
                <div class="question">
                    <label for="communicationStyle">×¡×’× ×•×Ÿ ×ª×§×©×•×¨×ª ××•×¢×“×£ *</label>
                    <select id="communicationStyle" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="frequent">×ª×§×©×•×¨×ª ×ª×›×•×¤×”</option>
                        <option value="scheduled">×¤×’×™×©×•×ª ××ª×•×›× × ×•×ª</option>
                        <option value="minimal">×ª×§×©×•×¨×ª ××™× ×™××œ×™×ª</option>
                        <option value="flexible">×’××™×© ×œ×¤×™ ×”×¦×•×¨×š</option>
                    </select>
                </div>
                <div class="warning" id="warning4">×× × ××œ××™ ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×</div>
                <div class="button-group">
                    <button class="secondary" onclick="prevStep()">â† ×—×–×¨×”</button>
                    <button onclick="nextStep()">×”××©×š â†’</button>
                </div>
            </div>

            <!-- ×©×œ×‘ 5 -->
            <div class="step" id="step5">
                <h2>×ª×—×•××™ ×¢× ×™×™×Ÿ (××•×¤×¦×™×•× ×œ×™)</h2>
                <div class="question">
                    <label for="lifeInterest">×ª×—×•××™ ×¢× ×™×™×Ÿ ××—×•×¥ ×œ×˜×›× ×•×œ×•×’×™×”</label>
                    <input type="text" id="lifeInterest" placeholder="×œ××©×œ: ×¡×¤×•×¨×˜, ××× ×•×ª, ××•×–×™×§×”...">
                </div>
                <div class="question">
                    <label for="importanceLevel">×›××” ×—×©×•×‘ ×œ×š ×”×ª×××” ××™×©×™×ª? *</label>
                    <select id="importanceLevel" required>
                        <option value="">×‘×—×¨×™...</option>
                        <option value="very_high">×××•×“ ×—×©×•×‘</option>
                        <option value="high">×—×©×•×‘</option>
                        <option value="medium">×‘×™× ×•× ×™</option>
                        <option value="low">×¤×—×•×ª ×—×©×•×‘</option>
                    </select>
                </div>
                <div class="warning" id="warning5">×× × ××œ××™ ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×</div>
                <div class="button-group">
                    <button class="secondary" onclick="prevStep()">â† ×—×–×¨×”</button>
                    <button onclick="finish()">×¡×™×•× ×•×©×œ×™×—×”</button>
                </div>
            </div>

            <div class="loading" id="loading">
                <p>×©×•××¨ ××ª ×”×ª×©×•×‘×•×ª ×©×œ×š...</p>
            </div>
        </div>
    </div>

    <!-- Firebase Firestore -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, doc, setDoc, updateDoc, increment } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        db._settings.experimentalForceLongPolling = true;
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Get sessionId from URL
        const urlParams = new URLSearchParams(window.location.search);
        const sessionId = urlParams.get('session');

        if (!sessionId) {
            alert('×©×’×™××”: ×œ× × ××¦× ×§×•×“ ×¤×¢×™×œ×•×ª');
            window.location.href = 'pairing.html';
        }

        let currentStep = 1;
        const totalSteps = 5;

        window.nextStep = function() {
            if (!validateStep(currentStep)) {
                document.getElementById(`warning${currentStep}`).classList.add('show');
                setTimeout(() => {
                    document.getElementById(`warning${currentStep}`).classList.remove('show');
                }, 3000);
                return;
            }

            if (currentStep < totalSteps) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgress();
            }
        };

        window.prevStep = function() {
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgress();
            }
        };

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function validateStep(step) {
            switch(step) {
                case 1:
                    return document.getElementById('displayName').value.trim() !== '' &&
                           document.getElementById('mainDomain').value !== '';
                case 2:
                    return document.getElementById('workStyle').value !== '' &&
                           document.getElementById('teamStyle').value !== '' &&
                           document.getElementById('workPace').value !== '';
                case 3:
                    return document.getElementById('teamRole').value !== '' &&
                           document.getElementById('motivationSource').value !== '' &&
                           document.getElementById('pressureResponse').value !== '';
                case 4:
                    return document.getElementById('conflictStyle').value !== '' &&
                           document.getElementById('communicationStyle').value !== '';
                case 5:
                    return document.getElementById('importanceLevel').value !== '';
                default:
                    return true;
            }
        }

        window.finish = async function() {
            if (!validateStep(5)) {
                document.getElementById('warning5').classList.add('show');
                setTimeout(() => {
                    document.getElementById('warning5').classList.remove('show');
                }, 3000);
                return;
            }

            document.getElementById('loading').classList.add('show');

            const payload = {
                sessionId: sessionId,
                deviceId: getDeviceId(),
                displayName: document.getElementById('displayName').value.trim(),
                mainDomain: document.getElementById('mainDomain').value,
                secondDomain: document.getElementById('secondDomain').value || null,
                workStyle: document.getElementById('workStyle').value,
                teamStyle: document.getElementById('teamStyle').value,
                workPace: document.getElementById('workPace').value,
                teamRole: document.getElementById('teamRole').value,
                motivationSource: document.getElementById('motivationSource').value,
                pressureResponse: document.getElementById('pressureResponse').value,
                conflictStyle: document.getElementById('conflictStyle').value,
                communicationStyle: document.getElementById('communicationStyle').value,
                lifeInterest: document.getElementById('lifeInterest').value.trim() || null,
                importanceLevel: document.getElementById('importanceLevel').value,
                createdAt: new Date().toISOString()
            };

            try {
                // ×©××™×¨×ª ×”×ª×©×•×‘×”
                const responseId = crypto.randomUUID();
                await setDoc(doc(db, 'responses', responseId), payload);

                // ×¢×“×›×•×Ÿ ×”××•× ×”
                const sessionRef = doc(db, 'sessions', sessionId);
                await updateDoc(sessionRef, {
                    completedCount: increment(1)
                });

                alert('×ª×•×“×”! ×”×ª×©×•×‘×•×ª ×©×œ×š × ×©××¨×• ×‘×”×¦×œ×—×” ğŸ‰');
                window.location.href = 'pairing.html';
            } catch (error) {
                console.error('Error saving:', error);
                alert('×©×’×™××” ×‘×©××™×¨×ª ×”× ×ª×•× ×™×. ×× × × ×¡×™ ×©×•×‘.');
                document.getElementById('loading').classList.remove('show');
            }
        };

        function getDeviceId() {
            let deviceId = localStorage.getItem('deviceId');
            if (!deviceId) {
                deviceId = crypto.randomUUID();
                localStorage.setItem('deviceId', deviceId);
            }
            return deviceId;
        }
    </script>
</body>
</html>
